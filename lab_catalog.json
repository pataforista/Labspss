{
  "meta": {
    "dataset_id": "labs_catalog_v1",
    "language": "es",
    "units_policy": "prefer_SI_with_clinical_conventions",
    "disclaimer": "Apoya revisión y documentación. No emite diagnósticos; sugiere verificación y descarte/confirmación."
  },
  "panels": [
    {
      "panel_id": "cbc",
      "name": "Citometría hemática (BH/CBC)",
      "analytes": [
        {
          "analyte_id": "hb",
          "name": "Hemoglobina",
          "units": "g/dL",
          "ref_ranges": [
            { "sex": "male", "low": 13.5, "high": 17.5 },
            { "sex": "female", "low": 12.0, "high": 16.0 }
          ],
          "critical": [
            { "op": "<", "value": 7.0, "label": "crítica_baja" },
            { "op": ">", "value": 20.0, "label": "crítica_alta" }
          ],
          "interpretation_hints": [
            "Interpretar junto con VCM, RDW y reticulocitos.",
            "Si Hb baja: clasificar anemia por VCM (micro/normo/macro)."
          ],
          "follow_up_checklist": [
            "VCM, RDW, reticulocitos.",
            "Perfil de hierro (ferritina, Fe, TIBC/sat transferrina) si microcítica.",
            "B12/folato si macrocítica.",
            "Datos de hemólisis si reticulocitos altos (LDH, bilirrubina indirecta, haptoglobina ± Coombs).",
            "Sangrado agudo vs crónico (clínica + tendencia de BH)."
          ]
        },
        {
          "analyte_id": "hct",
          "name": "Hematocrito",
          "units": "%",
          "ref_ranges": [
            { "sex": "male", "low": 41.0, "high": 53.0 },
            { "sex": "female", "low": 36.0, "high": 46.0 }
          ],
          "interpretation_hints": [
            "Útil para hemodilución/hemoconcentración; correlacionar con Hb."
          ],
          "follow_up_checklist": [
            "Si alto: descartar hemoconcentración (deshidratación) vs poliglobulia (EPOC/SAOS/altitud, EPO exógena, PV).",
            "Si bajo: misma ruta que Hb."
          ]
        },
        {
          "analyte_id": "mcv",
          "name": "VCM",
          "units": "fL",
          "ref_ranges": [{ "sex": "any", "low": 80.0, "high": 100.0 }],
          "interpretation_hints": [
            "<80: microcitosis (ferropenia/talasemia/sideroblástica).",
            "80-100: normocitosis (enfermedad crónica/hemólisis/sangrado agudo/renal).",
            ">100: macrocitosis (B12/folato, alcohol, hepatopatía, hipotiroidismo, MDS, fármacos)."
          ],
          "follow_up_checklist": [
            "Microcitosis: ferritina primero; si no baja, evaluar inflamación/ferropenia funcional; considerar electroforesis Hb si sospecha talasemia.",
            "Macrocitosis: B12, folato, TSH, PFH; revisar alcohol y fármacos; si citopenias múltiples, considerar MDS/medular."
          ]
        },
        {
          "analyte_id": "rdw",
          "name": "RDW (ADE)",
          "units": "%",
          "ref_ranges": [{ "sex": "any", "low": 11.5, "high": 14.5 }],
          "interpretation_hints": [
            "RDW alto con VCM bajo: sugiere ferropenia.",
            "RDW normal con VCM bajo: sugiere talasemia menor (no excluye mixtos)."
          ],
          "follow_up_checklist": [
            "Comparar con frotis periférico si discordancia clínica.",
            "Si RDW alto + macro: pensar megaloblástica o mixtas."
          ]
        },
        {
          "analyte_id": "retic",
          "name": "Reticulocitos",
          "units": "%",
          "ref_ranges": [{ "sex": "any", "low": 0.5, "high": 2.5 }],
          "derived": {
            "notes": "Ideal registrar absoluto o calcular RPI si anemia."
          },
          "interpretation_hints": [
            "Altos: respuesta medular (hemólisis o sangrado).",
            "Bajos/inadecuados: hipoproliferativa (carencial, inflamatoria, renal, medular)."
          ],
          "follow_up_checklist": [
            "Si altos: hemólisis (LDH, BI, haptoglobina ± Coombs), sangrado agudo.",
            "Si bajos: hierro/B12/folato, función renal (EPO), inflamación, médula."
          ]
        },
        {
          "analyte_id": "wbc",
          "name": "Leucocitos totales",
          "units": "/µL",
          "ref_ranges": [{ "sex": "any", "low": 4000, "high": 11000 }],
          "critical": [
            { "op": "<", "value": 2000, "label": "crítica_baja" },
            { "op": ">", "value": 30000, "label": "crítica_alta" }
          ],
          "interpretation_hints": ["Interpretar con diferencial absoluto (ANC/ALC), no solo porcentajes."],
          "follow_up_checklist": [
            "Revisar ANC/ALC.",
            "Buscar bandemia/desviación a la izquierda si sospecha bacteriana.",
            "Fármacos: esteroides/litio (leucocitosis); clozapina/carbamazepina (leucopenia)."
          ]
        },
        {
          "analyte_id": "anc",
          "name": "Neutrófilos absolutos (ANC)",
          "units": "/µL",
          "ref_ranges": [{ "sex": "any", "low": 1800, "high": 7700 }],
          "flags": [
            { "op": "<", "value": 1500, "label": "neutropenia" },
            { "op": "<", "value": 1000, "label": "neutropenia_moderada" },
            { "op": "<", "value": 500, "label": "neutropenia_severa" }
          ],
          "interpretation_hints": [
            "Neutrofilia: bacteriana/estrés/esteroides/mieloproliferativo.",
            "Neutropenia: viral, fármacos, autoinmune, médula."
          ],
          "follow_up_checklist": [
            "Si neutropenia: cronología + fármacos; síntomas infecciosos; frotis si dudas; evaluar causas según contexto.",
            "Si sospecha infección bacteriana: buscar bandemia."
          ]
        },
        {
          "analyte_id": "alc",
          "name": "Linfocitos absolutos (ALC)",
          "units": "/µL",
          "ref_ranges": [{ "sex": "any", "low": 1000, "high": 4800 }],
          "interpretation_hints": [
            "Linfocitosis: viral, tos ferina, LLC.",
            "Linfopenia: VIH, sepsis, esteroides, LES, desnutrición."
          ],
          "follow_up_checklist": [
            "Si linfopenia persistente: revisar riesgo VIH, esteroides, enfermedad sistémica.",
            "Si linfocitosis persistente: frotis y considerar hematología."
          ]
        },
        {
          "analyte_id": "eos_abs",
          "name": "Eosinófilos absolutos",
          "units": "/µL",
          "ref_ranges": [{ "sex": "any", "low": 0, "high": 500 }],
          "flags": [{ "op": ">", "value": 1500, "label": "hipereosinofilia" }],
          "interpretation_hints": [
            "Eosinofilia: alergia/asma, fármacos, parasitosis, colagenopatías, neoplasia, insuficiencia suprarrenal."
          ],
          "follow_up_checklist": [
            "Fármacos nuevos y atopia/asma.",
            "Exposición parasitaria; copro/serologías según contexto.",
            "Si >1500 sostenido: buscar daño de órgano diana y etiología secundaria vs primaria."
          ]
        },
        {
          "analyte_id": "plt",
          "name": "Plaquetas",
          "units": "/µL",
          "ref_ranges": [{ "sex": "any", "low": 150000, "high": 450000 }],
          "flags": [
            { "op": "<", "value": 100000, "label": "trombocitopenia" },
            { "op": "<", "value": 50000, "label": "riesgo_procedimientos" },
            { "op": "<", "value": 20000, "label": "riesgo_hemorragia_espontanea" },
            { "op": ">", "value": 450000, "label": "trombocitosis" }
          ],
          "interpretation_hints": [
            "Trombocitopenia: descartar pseudo por EDTA y revisar frotis.",
            "Trombocitosis: reactiva (inflamación/ferropenia) vs clonal."
          ],
          "follow_up_checklist": [
            "Si bajas: repetir con citrato si sospecha pseudo; frotis; fármacos; consumo/destrucción según clínica.",
            "Si altas: buscar inflamación/ferropenia; si persistente marcada sin causa, valorar mieloproliferativo."
          ]
        }
      ],
      "rules": [
        {
          "rule_id": "cbc_anemia_classification",
          "name": "Clasificación de anemia por VCM",
          "inputs_required": ["hb", "mcv", "rdw", "retic"],
          "triggers": [{ "if": { "analyte": "hb", "status": "low" } }],
          "outputs": [
            {
              "type": "pattern_hint",
              "text": "Hb baja: clasificar por VCM; RDW ayuda ferropenia vs talasemia; reticulocitos para respuesta medular."
            }
          ]
        }
      ]
    },

    {
      "panel_id": "bmp",
      "name": "Química básica (BMP)",
      "analytes": [
        {
          "analyte_id": "glucose_fasting",
          "name": "Glucosa (ayuno)",
          "units": "mg/dL",
          "ref_ranges": [{ "sex": "any", "low": 70, "high": 99 }],
          "flags": [
            { "op": ">=", "value": 100, "label": "alterada_ayuno_prediabetes" },
            { "op": ">=", "value": 126, "label": "criterio_diabetes_confirmar" }
          ],
          "follow_up_checklist": ["Confirmar con repetición en ayuno o HbA1c.", "Considerar hiperglucemia por estrés según contexto."]
        },
        {
          "analyte_id": "bun",
          "name": "BUN",
          "units": "mg/dL",
          "ref_ranges": [{ "sex": "any", "low": 7, "high": 20 }],
          "follow_up_checklist": ["Calcular BUN/Cr; si >20 sugiere componente prerrenal (depleción/IC/sangrado GI)."]
        },
        {
          "analyte_id": "creatinine",
          "name": "Creatinina",
          "units": "mg/dL",
          "ref_ranges": [
            { "sex": "male", "low": 0.7, "high": 1.3 },
            { "sex": "female", "low": 0.6, "high": 1.1 }
          ],
          "follow_up_checklist": [
            "Calcular eGFR y estadificar si crónico.",
            "Si agudo: AKI KDIGO (incremento Cr/diuresis).",
            "Revisar nefrotóxicos y estado hemodinámico."
          ]
        },
        {
          "analyte_id": "sodium",
          "name": "Sodio (Na)",
          "units": "mEq/L",
          "ref_ranges": [{ "sex": "any", "low": 135, "high": 145 }],
          "flags": [
            { "op": "<", "value": 130, "label": "hiponatremia_moderada" },
            { "op": "<", "value": 125, "label": "hiponatremia_severa" },
            { "op": ">", "value": 155, "label": "hipernatremia_severa" }
          ],
          "follow_up_checklist": [
            "Osmolaridad plasmática (hipo/iso/hiperosmolar).",
            "Osmolaridad urinaria + Na urinario.",
            "Evaluación clínica de volemia.",
            "Revisar fármacos asociados a SIADH y polidipsia."
          ]
        },
        {
          "analyte_id": "potassium",
          "name": "Potasio (K)",
          "units": "mEq/L",
          "ref_ranges": [{ "sex": "any", "low": 3.5, "high": 5.0 }],
          "flags": [
            { "op": ">", "value": 5.5, "label": "hiperkalemia" },
            { "op": ">", "value": 6.0, "label": "hiperkalemia_severa" },
            { "op": "<", "value": 3.0, "label": "hipokalemia_moderada" }
          ],
          "follow_up_checklist": [
            "Descartar hemólisis preanalítica si K alto inesperado.",
            "EKG si K ≥6 o síntomas.",
            "Revisar fármacos (IECA/ARAII, espironolactona, TMP-SMX) y ERC.",
            "Revisar bicarbonato y estado ácido-base."
          ]
        },
        { "analyte_id": "chloride", "name": "Cloro (Cl)", "units": "mEq/L", "ref_ranges": [{ "sex": "any", "low": 98, "high": 106 }] },
        {
          "analyte_id": "bicarb",
          "name": "Bicarbonato (HCO3-)",
          "units": "mEq/L",
          "ref_ranges": [{ "sex": "any", "low": 22, "high": 28 }],
          "flags": [{ "op": "<", "value": 20, "label": "acidosis_metabolica_probable" }],
          "follow_up_checklist": [
            "Calcular anion gap (AG).",
            "Considerar lactato/cetonas/uremia/tóxicos según contexto.",
            "Gasometría si impacto clínico."
          ]
        }
      ],
      "derived_metrics": [
        {
          "metric_id": "anion_gap",
          "name": "Anion Gap",
          "units": "mEq/L",
          "formula": "Na - (Cl + HCO3)",
          "ref_range": { "low": 8, "high": 12 },
          "interpretation_hints": [">12: acidosis con gap elevado (lactato, cetoacidosis, uremia, tóxicos)."]
        },
        {
          "metric_id": "bun_cr_ratio",
          "name": "Relación BUN/Cr",
          "units": "ratio",
          "formula": "BUN / Creatinina",
          "interpretation_hints": [">20 sugiere componente prerrenal (depleción/IC/sangrado GI)."]
        }
      ]
    },

    {
      "panel_id": "lft",
      "name": "Pruebas de función hepática (PFH)",
      "analytes": [
        { "analyte_id": "alt", "name": "ALT (TGP)", "units": "U/L", "ref_ranges": [{ "sex": "any", "low": 7, "high": 56 }], "follow_up_checklist": ["Comparar con FA/GGT (patrón).", "Historia farmacológica/tóxicos.", "Serologías si indicado.", "INR si sospecha falla sintética."] },
        { "analyte_id": "ast", "name": "AST (TGO)", "units": "U/L", "ref_ranges": [{ "sex": "any", "low": 10, "high": 40 }], "follow_up_checklist": ["Considerar músculo/hemólisis si elevación aislada.", "Relación AST/ALT en contexto clínico."] },
        { "analyte_id": "alp", "name": "Fosfatasa Alcalina (FA)", "units": "U/L", "ref_ranges": [{ "sex": "any", "low": 40, "high": 130 }], "follow_up_checklist": ["GGT o 5'-nucleotidasa para origen hepático.", "USG hepatobiliar si colestasis clínica."] },
        { "analyte_id": "ggt", "name": "GGT", "units": "U/L", "ref_ranges": [{ "sex": "any", "low": 9, "high": 48 }] },
        { "analyte_id": "bili_total", "name": "Bilirrubina total", "units": "mg/dL", "ref_ranges": [{ "sex": "any", "low": 0.3, "high": 1.2 }] },
        { "analyte_id": "bili_direct", "name": "Bilirrubina directa", "units": "mg/dL", "ref_ranges": [{ "sex": "any", "low": 0.0, "high": 0.3 }] },
        { "analyte_id": "albumin", "name": "Albúmina", "units": "g/dL", "ref_ranges": [{ "sex": "any", "low": 3.5, "high": 5.0 }] },
        { "analyte_id": "inr", "name": "INR", "units": "ratio", "ref_ranges": [{ "sex": "any", "low": 0.9, "high": 1.1 }], "follow_up_checklist": ["Confirmar anticoagulantes/biotina/vitamina K.", "Si prolongado sin AC: falla hepática aguda vs cirrosis avanzada."] }
      ],
      "derived_metrics": [
        { "metric_id": "ast_alt_ratio", "name": "Relación AST/ALT", "units": "ratio", "formula": "AST / ALT", "interpretation_hints": [">2 sugiere etiología alcohólica (no exclusiva)."] }
      ]
    },

    {
      "panel_id": "thyroid",
      "name": "Perfil tiroideo",
      "analytes": [
        {
          "analyte_id": "tsh",
          "name": "TSH",
          "units": "µUI/mL",
          "ref_ranges": [{ "sex": "any", "low": 0.4, "high": 4.5 }],
          "flags": [
            { "op": ">", "value": 10.0, "label": "hipotiroidismo_probable_relevante" },
            { "op": "<", "value": 0.1, "label": "hipertiroidismo_probable_relevante" }
          ],
          "follow_up_checklist": ["T4 libre si TSH alterada.", "Anti-TPO si sospecha autoinmune.", "Revisar litio/amiodarona/biotina y enfermedad no tiroidea."]
        },
        { "analyte_id": "ft4", "name": "T4 libre", "units": "ng/dL", "ref_ranges": [{ "sex": "any", "low": 0.8, "high": 1.8 }] }
      ]
    },

    {
      "panel_id": "lipids",
      "name": "Perfil de lípidos",
      "analytes": [
        { "analyte_id": "ldl", "name": "LDL-C", "units": "mg/dL", "ref_ranges": [{ "sex": "any", "low": 0, "high": 100 }], "follow_up_checklist": ["Interpretar por riesgo CV global.", "Descartar causas secundarias (hipotiroidismo, nefrosis, colestasis)."] },
        { "analyte_id": "hdl", "name": "HDL-C", "units": "mg/dL", "ref_ranges": [{ "sex": "male", "low": 40, "high": 999 }, { "sex": "female", "low": 50, "high": 999 }] },
        {
          "analyte_id": "triglycerides",
          "name": "Triglicéridos",
          "units": "mg/dL",
          "ref_ranges": [{ "sex": "any", "low": 0, "high": 150 }],
          "flags": [
            { "op": ">=", "value": 500, "label": "riesgo_pancreatitis" },
            { "op": ">=", "value": 1000, "label": "alto_riesgo_pancreatitis" }
          ],
          "follow_up_checklist": ["Buscar DM no controlada, alcohol, fármacos, hipotiroidismo, ERC.", "Si muy altos: correlacionar con clínica abdominal/pancreatitis."]
        },
        { "analyte_id": "chol_total", "name": "Colesterol total", "units": "mg/dL", "ref_ranges": [{ "sex": "any", "low": 0, "high": 200 }] }
      ]
    },

    {
      "panel_id": "ua",
      "name": "EGO (tira reactiva + sedimento)",
      "analytes": [
        { "analyte_id": "urine_sg", "name": "Densidad urinaria", "units": "ratio", "ref_ranges": [{ "sex": "any", "low": 1.005, "high": 1.030 }] },
        { "analyte_id": "urine_ph", "name": "pH urinario", "units": "pH", "ref_ranges": [{ "sex": "any", "low": 4.5, "high": 8.0 }] },
        { "analyte_id": "nitrites", "name": "Nitritos", "units": "qual", "ref_ranges": [{ "sex": "any", "qualitative_normal": "negativo" }] },
        { "analyte_id": "leukocyte_esterase", "name": "Esterasa leucocitaria", "units": "qual", "ref_ranges": [{ "sex": "any", "qualitative_normal": "negativo" }] },
        {
          "analyte_id": "protein_dip",
          "name": "Proteínas (tira)",
          "units": "qual",
          "ref_ranges": [{ "sex": "any", "qualitative_normal": "negativo" }],
          "follow_up_checklist": ["Si positivo: cuantificar (ACR en muestra al azar o 24h).", "Correlacionar con sedimento y clínica."]
        },
        { "analyte_id": "rbc_urine", "name": "Eritrocitos en orina", "units": "RBC/HPF", "ref_ranges": [{ "sex": "any", "low": 0, "high": 2 }], "follow_up_checklist": ["Si hematuria: dismorfia eritrocitaria y cilindros hemáticos (glomerular).", "Descartar litiasis/infección/neoplasia según riesgo."] },
        {
          "analyte_id": "casts",
          "name": "Cilindros (tipo)",
          "units": "text",
          "ref_ranges": [{ "sex": "any" }],
          "interpretation_hints": [
            "Hialinos: deshidratación/ejercicio (inespecífico).",
            "Granulosos: NTA.",
            "Hemáticos: glomerulonefritis.",
            "Leucocitarios: pielonefritis o nefritis intersticial."
          ]
        }
      ]
    }
  ]
}
